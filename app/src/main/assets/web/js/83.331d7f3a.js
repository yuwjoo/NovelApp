"use strict";(self["webpackChunknovel_web"]=self["webpackChunknovel_web"]||[]).push([[83],{887:function(){},4136:function(e,t,n){n.r(t),n.d(t,{default:function(){return ae}});var l=n(1049),r=n(4726),a=n(6768),o=n(144),i=n(5828),s=n(8442),u=n(6370),c=n(240),d=(n(8111),n(2489),n(8237),n(3579),n(4612)),g=n(7905);function f(e){return Array.isArray(e)?!e.length:0!==e&&!e}function h(e,t){if(f(e)){if(t.required)return!1;if(!1===t.validateEmpty)return!0}return!(t.pattern&&!t.pattern.test(String(e)))}function v(e,t){return new Promise((n=>{const l=t.validator(e,t);(0,s.yL)(l)?l.then(n):n(l)}))}function p(e,t){const{message:n}=t;return(0,s.Tn)(n)?n(e,t):n||""}function b({target:e}){e.composing=!0}function m({target:e}){e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}function y(e,t){const n=(0,c.Td)();e.style.height="auto";let l=e.scrollHeight;if((0,s.Gv)(t)){const{maxHeight:e,minHeight:n}=t;void 0!==e&&(l=Math.min(l,e)),void 0!==n&&(l=Math.max(l,n))}l&&(e.style.height=`${l}px`,(0,c.Fk)(n))}function k(e,t){return"number"===e&&(e="text",null!=t||(t="decimal")),"digit"===e&&(e="tel",null!=t||(t="numeric")),{type:e,inputmode:t}}function w(e){return[...e].length}function C(e,t){return[...e].slice(0,t).join("")}var x=n(6261),S=n(6591),F=n(9614),V=n(6145),I=n(5314),T=n(8139);const[E,B]=(0,i.YX)("field"),M={id:String,name:String,leftIcon:String,rightIcon:String,autofocus:Boolean,clearable:Boolean,maxlength:u.VQ,max:Number,min:Number,formatter:Function,clearIcon:(0,u.Ts)("clear"),modelValue:(0,u.TU)(""),inputAlign:String,placeholder:String,autocomplete:String,autocapitalize:String,autocorrect:String,errorMessage:String,enterkeyhint:String,clearTrigger:(0,u.Ts)("focus"),formatTrigger:(0,u.Ts)("onChange"),spellcheck:{type:Boolean,default:null},error:{type:Boolean,default:null},disabled:{type:Boolean,default:null},readonly:{type:Boolean,default:null},inputmode:String},$=(0,s.X$)({},x.yH,M,{rows:u.VQ,type:(0,u.Ts)("text"),rules:Array,autosize:[Boolean,Object],labelWidth:u.VQ,labelClass:u.E9,labelAlign:String,showWordLimit:Boolean,errorMessageAlign:String,colon:{type:Boolean,default:null}});var A=(0,a.pM)({name:E,props:$,emits:["blur","focus","clear","keypress","clickInput","endValidate","startValidate","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:t,slots:n}){const l=(0,F.B)(),r=(0,o.Kh)({status:"unvalidated",focused:!1,validateMessage:""}),i=(0,o.KR)(),u=(0,o.KR)(),x=(0,o.KR)(),{parent:E}=(0,S.cJ)(d.$i),M=()=>{var t;return String(null!=(t=e.modelValue)?t:"")},$=t=>(0,s.C8)(e[t])?e[t]:E&&(0,s.C8)(E.props[t])?E.props[t]:void 0,A=(0,a.EW)((()=>{const t=$("readonly");if(e.clearable&&!t){const t=""!==M(),n="always"===e.clearTrigger||"focus"===e.clearTrigger&&r.focused;return t&&n}return!1})),_=(0,a.EW)((()=>x.value&&n.input?x.value():e.modelValue)),R=(0,a.EW)((()=>{var t;const n=$("required");return"auto"===n?null==(t=e.rules)?void 0:t.some((e=>e.required)):n})),L=e=>e.reduce(((e,t)=>e.then((()=>{if("failed"===r.status)return;let{value:e}=_;if(t.formatter&&(e=t.formatter(e,t)),!h(e,t))return r.status="failed",void(r.validateMessage=p(e,t));if(t.validator){if(f(e)&&!1===t.validateEmpty)return;return v(e,t).then((n=>{n&&"string"===typeof n?(r.status="failed",r.validateMessage=n):!1===n&&(r.status="failed",r.validateMessage=p(e,t))}))}}))),Promise.resolve()),z=()=>{r.status="unvalidated",r.validateMessage=""},W=()=>t("endValidate",{status:r.status,message:r.validateMessage}),q=(n=e.rules)=>new Promise((l=>{z(),n?(t("startValidate"),L(n).then((()=>{"failed"===r.status?(l({name:e.name,message:r.validateMessage}),W()):(r.status="passed",l(),W())}))):l()})),K=t=>{if(E&&e.rules){const{validateTrigger:n}=E.props,l=(0,s.$r)(n).includes(t),r=e.rules.filter((e=>e.trigger?(0,s.$r)(e.trigger).includes(t):l));r.length&&q(r)}},X=t=>{var n;const{maxlength:l}=e;if((0,s.C8)(l)&&w(t)>+l){const e=M();if(e&&w(e)===+l)return e;const a=null==(n=i.value)?void 0:n.selectionEnd;if(r.focused&&a){const e=[...t],n=e.length-+l;return e.splice(a-n,n),e.join("")}return C(t,+l)}return t},P=(n,l="onChange")=>{var a,o;const u=n;n=X(n);const c=w(u)-w(n);if("number"===e.type||"digit"===e.type){const t="number"===e.type;if(n=(0,g.ZV)(n,t,t),"onBlur"===l&&""!==n&&(void 0!==e.min||void 0!==e.max)){const t=(0,g.qE)(+n,null!=(a=e.min)?a:-1/0,null!=(o=e.max)?o:1/0);+n!==t&&(n=t.toString())}}let d=0;if(e.formatter&&l===e.formatTrigger){const{formatter:t,maxlength:l}=e;if(n=t(n),(0,s.C8)(l)&&w(n)>+l&&(n=C(n,+l)),i.value&&r.focused){const{selectionEnd:e}=i.value,n=C(u,e);d=w(t(n))-w(n)}}if(i.value&&i.value.value!==n)if(r.focused){let{selectionStart:e,selectionEnd:t}=i.value;if(i.value.value=n,(0,s.C8)(e)&&(0,s.C8)(t)){const l=w(n);c?(e-=c,t-=c):d&&(e+=d,t+=d),i.value.setSelectionRange(Math.min(e,l),Math.min(t,l))}}else i.value.value=n;n!==e.modelValue&&t("update:modelValue",n)},Y=e=>{e.target.composing||P(e.target.value)},D=()=>{var e;return null==(e=i.value)?void 0:e.blur()},G=()=>{var e;return null==(e=i.value)?void 0:e.focus()},Q=()=>{const t=i.value;"textarea"===e.type&&e.autosize&&t&&y(t,e.autosize)},j=e=>{r.focused=!0,t("focus",e),(0,a.dY)(Q),$("readonly")&&D()},H=e=>{r.focused=!1,P(M(),"onBlur"),t("blur",e),$("readonly")||(K("onBlur"),(0,a.dY)(Q),(0,c.B0)())},U=e=>t("clickInput",e),O=e=>t("clickLeftIcon",e),N=e=>t("clickRightIcon",e),J=e=>{(0,c.wo)(e),t("update:modelValue",""),t("clear",e)},Z=(0,a.EW)((()=>"boolean"===typeof e.error?e.error:!(!E||!E.props.showError||"failed"!==r.status)||void 0)),ee=(0,a.EW)((()=>{const e=$("labelWidth"),t=$("labelAlign");if(e&&"top"!==t)return{width:(0,g._V)(e)}})),te=n=>{const l=13;if(n.keyCode===l){const t=E&&E.props.submitOnEnter;t||"textarea"===e.type||(0,c.wo)(n),"search"===e.type&&D()}t("keypress",n)},ne=()=>e.id||`${l}-input`,le=()=>r.status,re=()=>{const t=B("control",[$("inputAlign"),{error:Z.value,custom:!!n.input,"min-height":"textarea"===e.type&&!e.autosize}]);if(n.input)return(0,a.bF)("div",{class:t,onClick:U},[n.input()]);const r={id:ne(),ref:i,name:e.name,rows:void 0!==e.rows?+e.rows:void 0,class:t,disabled:$("disabled"),readonly:$("readonly"),autofocus:e.autofocus,placeholder:e.placeholder,autocomplete:e.autocomplete,autocapitalize:e.autocapitalize,autocorrect:e.autocorrect,enterkeyhint:e.enterkeyhint,spellcheck:e.spellcheck,"aria-labelledby":e.label?`${l}-label`:void 0,"data-allow-mismatch":"attribute",onBlur:H,onFocus:j,onInput:Y,onClick:U,onChange:m,onKeypress:te,onCompositionend:m,onCompositionstart:b};return"textarea"===e.type?(0,a.bF)("textarea",(0,a.v6)(r,{inputmode:e.inputmode}),null):(0,a.bF)("input",(0,a.v6)(k(e.type,e.inputmode),r),null)},ae=()=>{const t=n["left-icon"];if(e.leftIcon||t)return(0,a.bF)("div",{class:B("left-icon"),onClick:O},[t?t():(0,a.bF)(I.In,{name:e.leftIcon,classPrefix:e.iconPrefix},null)])},oe=()=>{const t=n["right-icon"];if(e.rightIcon||t)return(0,a.bF)("div",{class:B("right-icon"),onClick:N},[t?t():(0,a.bF)(I.In,{name:e.rightIcon,classPrefix:e.iconPrefix},null)])},ie=()=>{if(e.showWordLimit&&e.maxlength){const t=w(M());return(0,a.bF)("div",{class:B("word-limit")},[(0,a.bF)("span",{class:B("word-num")},[t]),(0,a.eW)("/"),e.maxlength])}},se=()=>{if(E&&!1===E.props.showErrorMessage)return;const t=e.errorMessage||r.validateMessage;if(t){const e=n["error-message"],l=$("errorMessageAlign");return(0,a.bF)("div",{class:B("error-message",l)},[e?e({message:t}):t])}},ue=()=>{const t=$("labelWidth"),r=$("labelAlign"),o=$("colon")?":":"";return n.label?[n.label(),o]:e.label?(0,a.bF)("label",{id:`${l}-label`,for:n.input?void 0:ne(),"data-allow-mismatch":"attribute",onClick:e=>{(0,c.wo)(e),G()},style:"top"===r&&t?{width:(0,g._V)(t)}:void 0},[e.label+o]):void 0},ce=()=>[(0,a.bF)("div",{class:B("body")},[re(),A.value&&(0,a.bF)(I.In,{ref:u,name:e.clearIcon,class:B("clear")},null),oe(),n.button&&(0,a.bF)("div",{class:B("button")},[n.button()])]),ie(),se()];return(0,V.c)({blur:D,focus:G,validate:q,formValue:_,resetValidation:z,getValidationStatus:le}),(0,a.Gt)(S.f,{customValue:x,resetValidation:z,validateWithTrigger:K}),(0,a.wB)((()=>e.modelValue),(()=>{P(M()),z(),K("onChange"),(0,a.dY)(Q)})),(0,a.sV)((()=>{P(M(),e.formatTrigger),(0,a.dY)(Q)})),(0,S.ML)("touchstart",J,{target:(0,a.EW)((()=>{var e;return null==(e=u.value)?void 0:e.$el}))}),()=>{const t=$("disabled"),l=$("labelAlign"),r=ae(),o=()=>{const e=ue();return"top"===l?[r,e].filter(Boolean):e||[]};return(0,a.bF)(T.fh,{size:e.size,class:B({error:Z.value,disabled:t,[`label-${l}`]:l}),center:e.center,border:e.border,isLink:e.isLink,clickable:e.clickable,titleStyle:ee.value,valueClass:B("value"),titleClass:[B("label",[l,{required:R.value}]),e.labelClass],arrowDirection:e.arrowDirection},{icon:r&&"top"!==l?()=>r:null,title:o,value:ce,extra:n.extra})}}});const _=(0,r.G)(A);const[R,L,z]=(0,i.YX)("search"),W=(0,s.X$)({},M,{label:String,shape:(0,u.Ts)("square"),leftIcon:(0,u.Ts)("search"),clearable:u.Rd,actionText:String,background:String,showAction:Boolean});var q=(0,a.pM)({name:R,props:W,emits:["blur","focus","clear","search","cancel","clickInput","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:t,slots:n,attrs:l}){const r=(0,F.B)(),i=(0,o.KR)(),u=()=>{n.action||(t("update:modelValue",""),t("cancel"))},d=n=>{const l=13;n.keyCode===l&&((0,c.wo)(n),t("search",e.modelValue))},g=()=>e.id||`${r}-input`,f=()=>{if(n.label||e.label)return(0,a.bF)("label",{class:L("label"),for:g(),"data-allow-mismatch":"attribute"},[n.label?n.label():e.label])},h=()=>{if(e.showAction){const t=e.actionText||z("cancel");return(0,a.bF)("div",{class:L("action"),role:"button",tabindex:0,onClick:u},[n.action?n.action():t])}},v=()=>{var e;return null==(e=i.value)?void 0:e.blur()},p=()=>{var e;return null==(e=i.value)?void 0:e.focus()},b=e=>t("blur",e),m=e=>t("focus",e),y=e=>t("clear",e),k=e=>t("clickInput",e),w=e=>t("clickLeftIcon",e),C=e=>t("clickRightIcon",e),x=Object.keys(M),S=()=>{const r=(0,s.X$)({},l,(0,s.Up)(e,x),{id:g()}),o=e=>t("update:modelValue",e);return(0,a.bF)(_,(0,a.v6)({ref:i,type:"search",class:L("field",{"with-message":r.errorMessage}),border:!1,onBlur:b,onFocus:m,onClear:y,onKeypress:d,onClickInput:k,onClickLeftIcon:w,onClickRightIcon:C,"onUpdate:modelValue":o},r),(0,s.Up)(n,["left-icon","right-icon"]))};return(0,V.c)({focus:p,blur:v}),()=>{var t;return(0,a.bF)("div",{class:L({"show-action":e.showAction}),style:{background:e.background}},[null==(t=n.left)?void 0:t.call(n),(0,a.bF)("div",{class:L("content",e.shape)},[f(),S()]),h()])}}});const K=(0,r.G)(q);n(6647),n(7708),n(7484),n(887),n(4114);var X=n(2376);n(1701);const[P,Y]=(0,i.YX)("highlight"),D={autoEscape:u.Rd,caseSensitive:Boolean,highlightClass:String,highlightTag:(0,u.Ts)("span"),keywords:(0,u.$g)([String,Array]),sourceString:(0,u.Ts)(""),tag:(0,u.Ts)("div"),unhighlightClass:String,unhighlightTag:(0,u.Ts)("span")};var G=(0,a.pM)({name:P,props:D,setup(e){const t=(0,a.EW)((()=>{const{autoEscape:t,caseSensitive:n,keywords:l,sourceString:r}=e,a=n?"g":"gi",o=Array.isArray(l)?l:[l];let i=o.filter((e=>e)).reduce(((e,n)=>{t&&(n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"));const l=new RegExp(n,a);let o;while(o=l.exec(r)){const t=o.index,n=l.lastIndex;t>=n?l.lastIndex++:e.push({start:t,end:n,highlight:!0})}return e}),[]);i=i.sort(((e,t)=>e.start-t.start)).reduce(((e,t)=>{const n=e[e.length-1];if(!n||t.start>n.end){const l=n?n.end:0,r=t.start;l!==r&&e.push({start:l,end:r,highlight:!1}),e.push(t)}else n.end=Math.max(n.end,t.end);return e}),[]);const s=i[i.length-1];return s||i.push({start:0,end:r.length,highlight:!1}),s&&s.end<r.length&&i.push({start:s.end,end:r.length,highlight:!1}),i})),n=()=>{const{sourceString:n,highlightClass:l,unhighlightClass:r,highlightTag:o,unhighlightTag:i}=e;return t.value.map((e=>{const{start:t,end:s,highlight:u}=e,c=n.slice(t,s);return u?(0,a.bF)(o,{class:[Y("tag"),l]},{default:()=>[c]}):(0,a.bF)(i,{class:r},{default:()=>[c]})}))};return()=>{const{tag:t}=e;return(0,a.bF)(t,{class:Y()},{default:()=>[n()]})}}});const Q=(0,r.G)(G);var j=n(4232),H=n(6275);const U={class:"book-item__info"},O={class:"book-item__classify"},N={class:"book-item__author"};var J=(0,a.pM)({name:"book-item",__name:"book-item",props:{index:{type:Number,required:!0},item:{type:Object,required:!0},searchValue:{type:String,required:!0}},setup(e){const t=(0,H.r)(),n=e=>{t.push({name:"book-detail",query:{id:e.id}})};return(t,l)=>{const r=Q;return(0,a.uX)(),(0,a.CE)("div",{class:"book-item",onClick:l[0]||(l[0]=t=>n(e.item))},[(0,a.bF)(r,{class:"book-item__title",keywords:[e.searchValue],"source-string":e.item.title},null,8,["keywords","source-string"]),(0,a.Lk)("div",U,[(0,a.Lk)("div",O,"分类："+(0,j.v_)(e.item.classify.name),1),(0,a.Lk)("div",N,[l[1]||(l[1]=(0,a.eW)(" 作者：")),(0,a.bF)(r,{keywords:[e.searchValue],"source-string":e.item.author.name},null,8,["keywords","source-string"])])])])}}}),Z=n(1241);const ee=(0,Z.A)(J,[["__scopeId","data-v-79bd6050"]]);var te=ee;const ne={class:"book-search"};var le=(0,a.pM)({name:"book-search",__name:"book-search",setup(e){const t=(0,o.KR)(""),n=(0,o.Kh)({current:1,size:0,total:0}),r=(0,o.KR)(!1),i=(0,o.KR)([]),s=()=>{n.current=1,n.size=0,n.total=0,c()},u=()=>{i.value=[]},c=async()=>{r.value=!0;try{const e=await(0,X.st)({searchValue:t.value,current:n.current});n.current=e.current,n.total=e.total,i.value.push(...e.list)}finally{r.value=!1}},d=()=>{!r.value&&n.current+1<=n.total/n.size&&(n.current++,c())};return(e,n)=>{const c=K,g=l.A;return(0,a.uX)(),(0,a.CE)("div",ne,[(0,a.bF)(c,{modelValue:(0,o.R1)(t),"onUpdate:modelValue":n[0]||(n[0]=e=>(0,o.i9)(t)?t.value=e:null),placeholder:"请输入书名或者作者名",onSearch:s,onClear:u},null,8,["modelValue"]),(0,a.bF)(g,{class:"book-search__list",list:(0,o.R1)(i),"min-item-size":80,loading:(0,o.R1)(r),"key-field":"id",onScrollToBottom:d},{default:(0,a.k6)((({item:e,index:n})=>[(0,a.bF)(te,{item:e,index:n,"search-value":(0,o.R1)(t)},null,8,["item","index","search-value"])])),_:1},8,["list","loading"])])}}});const re=(0,Z.A)(le,[["__scopeId","data-v-290cba39"]]);var ae=re},4612:function(e,t,n){n.d(t,{$i:function(){return s},Dk:function(){return i},Ez:function(){return c},kw:function(){return r},pT:function(){return a},wT:function(){return u},xm:function(){return o}});const l="van-hairline",r=`${l}--surround`,a=`${l}--top-bottom`,o=`${l}-unset--top-bottom`,i="van-haptics-feedback",s=Symbol("van-form"),u=500,c=5},6145:function(e,t,n){n.d(t,{c:function(){return a}});var l=n(6768),r=n(8442);function a(e){const t=(0,l.nI)();t&&(0,r.X$)(t.proxy,e)}},6261:function(e,t,n){n.d(t,{Ay:function(){return f},yH:function(){return d}});var l=n(6768),r=n(5828),a=n(6370),o=n(8442),i=n(4548),s=n(5314);const[u,c]=(0,r.YX)("cell"),d={tag:(0,a.Ts)("div"),icon:String,size:String,title:a.VQ,value:a.VQ,label:a.VQ,center:Boolean,isLink:Boolean,border:a.Rd,iconPrefix:String,valueClass:a.E9,labelClass:a.E9,titleClass:a.E9,titleStyle:null,arrowDirection:String,required:{type:[Boolean,String],default:null},clickable:{type:Boolean,default:null}},g=(0,o.X$)({},d,i.aI);var f=(0,l.pM)({name:u,props:g,setup(e,{slots:t}){const n=(0,i.lq)(),r=()=>{const n=t.label||(0,o.C8)(e.label);if(n)return(0,l.bF)("div",{class:[c("label"),e.labelClass]},[t.label?t.label():e.label])},a=()=>{var n;if(t.title||(0,o.C8)(e.title)){const a=null==(n=t.title)?void 0:n.call(t);if(Array.isArray(a)&&0===a.length)return;return(0,l.bF)("div",{class:[c("title"),e.titleClass],style:e.titleStyle},[a||(0,l.bF)("span",null,[e.title]),r()])}},u=()=>{const n=t.value||t.default,r=n||(0,o.C8)(e.value);if(r)return(0,l.bF)("div",{class:[c("value"),e.valueClass]},[n?n():(0,l.bF)("span",null,[e.value])])},d=()=>t.icon?t.icon():e.icon?(0,l.bF)(s.In,{name:e.icon,class:c("left-icon"),classPrefix:e.iconPrefix},null):void 0,g=()=>{if(t["right-icon"])return t["right-icon"]();if(e.isLink){const t=e.arrowDirection&&"right"!==e.arrowDirection?`arrow-${e.arrowDirection}`:"arrow";return(0,l.bF)(s.In,{name:t,class:c("right-icon")},null)}};return()=>{var r;const{tag:o,size:i,center:s,border:f,isLink:h,required:v}=e,p=null!=(r=e.clickable)?r:h,b={center:s,required:!!v,clickable:p,borderless:!f};return i&&(b[i]=!!i),(0,l.bF)(o,{class:c(b),role:p?"button":void 0,tabindex:p?0:void 0,onClick:n},{default:()=>{var e;return[d(),a(),u(),g(),null==(e=t.extra)?void 0:e.call(t)]}})}}})},8139:function(e,t,n){n.d(t,{fh:function(){return a}});var l=n(4726),r=n(6261);const a=(0,l.G)(r.Ay)},9614:function(e,t,n){n.d(t,{B:function(){return a}});var l=n(6768);let r=0;function a(){const e=(0,l.nI)(),{name:t="unknown"}=(null==e?void 0:e.type)||{};return`${t}-${++r}`}}}]);
//# sourceMappingURL=83.331d7f3a.js.map