"use strict";(self["webpackChunknovel_web"]=self["webpackChunknovel_web"]||[]).push([[890],{890:function(e,t,a){a.r(t),a.d(t,{default:function(){return K}});var n=a(2699),l=a(6431),i=(a(4114),a(6768)),s=a(144),o=a(5130),c=a(6275),r=a(3625),d=a(4232);const u={class:"book-item"},p={class:"book-item__title"};function v(e,t,a,n,l,s){return(0,i.uX)(),(0,i.CE)("div",u,[(0,i.Lk)("h1",p,(0,d.v_)(a.source.title),1),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(a.source.contents,((e,t)=>((0,i.uX)(),(0,i.CE)("p",{class:"book-item__text",key:t},(0,d.v_)(e),1)))),128))])}var k={name:"bookItem",props:{index:{type:Number},source:{type:Object,default(){return{}}}}},m=a(1241);const g=(0,m.A)(k,[["render",v],["__scopeId","data-v-70e166f7"]]);var b=g;const h={class:"back-group"},_={class:"setting-wrapper"},f={class:"setting-color"},C=["onClick"],y={class:"icon-tick"},L={class:"setting-font"},F={class:"setting-btn"},R={class:"setting-item"},x=["textContent"];function I(e,t,a,n,l,s){return(0,i.uX)(),(0,i.Wv)(o.eB,{name:"setting"},{default:(0,i.k6)((()=>[(0,i.bo)((0,i.Lk)("div",null,[(0,i.Lk)("div",h,[(0,i.Lk)("div",{class:"back-content",onClick:t[0]||(t[0]=(0,o.D$)(((...e)=>s.back&&s.back(...e)),["stop"]))},t[6]||(t[6]=[(0,i.Lk)("i",{class:"icon-arrow"},null,-1),(0,i.Lk)("span",null,"返回",-1)]))]),(0,i.bo)((0,i.Lk)("div",_,[(0,i.Lk)("div",f,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(l.color,((e,t)=>((0,i.uX)(),(0,i.CE)("div",{class:"color-item",key:t},[(0,i.Lk)("span",{class:(0,d.C4)(["item",{active:t===a.currentIndex}]),style:(0,d.Tr)({background:e}),onClick:a=>s.changeColor(e,t)},[(0,i.bo)((0,i.Lk)("i",y,null,512),[[o.aG,t===a.currentIndex]])],14,C)])))),128))]),(0,i.Lk)("div",L,[(0,i.Lk)("div",{class:"font-item",onClick:t[1]||(t[1]=(...e)=>s.minusFontSize&&s.minusFontSize(...e))},t[7]||(t[7]=[(0,i.Lk)("span",{class:"font-btn"},"A-",-1)])),(0,i.Lk)("div",{class:"font-item",onClick:t[2]||(t[2]=(...e)=>s.addFontSize&&s.addFontSize(...e))},t[8]||(t[8]=[(0,i.Lk)("span",{class:"font-btn"},"A+",-1)]))])],512),[[o.aG,a.showFlag&&l.setting]]),(0,i.Lk)("div",F,[(0,i.Lk)("div",R,[(0,i.Lk)("div",{class:"icon-wrapper",onClick:t[3]||(t[3]=(...e)=>s.openChapters&&s.openChapters(...e))},t[9]||(t[9]=[(0,i.Lk)("i",{class:"icon-directory"},null,-1)])),t[10]||(t[10]=(0,i.Lk)("span",{class:"title"},"目录",-1))]),(0,i.Lk)("div",{class:"setting-item",onClick:t[4]||(t[4]=(...e)=>s.changeMode&&s.changeMode(...e))},[(0,i.Lk)("i",{class:(0,d.C4)(s.modeCls)},null,2),(0,i.Lk)("span",{class:"title",textContent:(0,d.v_)(s.modeText)},null,8,x)]),(0,i.Lk)("div",{class:"setting-item",onClick:t[5]||(t[5]=(...e)=>s.openSetting&&s.openSetting(...e))},t[11]||(t[11]=[(0,i.Lk)("i",{class:"icon-setting"},null,-1),(0,i.Lk)("span",{class:"title"},"设置",-1)]))])],512),[[o.aG,a.showFlag]])])),_:1})}var S={props:{showFlag:{type:Boolean,default:!1},isNight:{type:Boolean,default:!1},currentIndex:{type:Number,default:0}},data(){return{setting:!1,color:["#f6f6f6","#e1d4b2","#bed8ab","#efc1c1","#dcc49e","#d9e8ff"]}},computed:{modeCls(){return this.isNight?"icon-brightness":"icon-night"},modeText(){return this.isNight?"白天":"夜间"}},methods:{back(){this.$emit("back")},openChapters(){this.$emit("openChapters")},changeMode(){this.$emit("changeMode")},openSetting(){this.setting=!this.setting,this.$emit("openSetting")},changeColor(e,t){this.$emit("changeColor",e,t)},minusFontSize(){this.$emit("minusFontSize")},addFontSize(){this.$emit("addFontSize")}},watch:{showFlag(e){!1===e&&(this.setting=!1)}}};const A=(0,m.A)(S,[["render",I],["__scopeId","data-v-0e46c656"]]);var X=A;const w={class:"book-read__catalog-header"};var E=(0,i.pM)({name:"bookRead",__name:"index",setup(e){const t=(0,c.l)(),a=(0,c.r)(),d=(0,s.KR)([]),u=(0,s.KR)(!1),p=(0,s.KR)(!1),v=(0,s.KR)([]),k=(0,i.EW)((()=>d.value[d.value.length-1].nextChapterId)),m=(0,s.KR)(!1),g=(0,s.KR)(!1),h=(0,s.KR)(!1),_=(0,s.KR)(0),f=()=>{g.value=!1,m.value=!0},C=()=>{h.value=!h.value},y=(e,t)=>{_.value=t},L=()=>{},F=()=>{},R=()=>{a.back()},x=async e=>{try{u.value=!0;const a=await(0,r.nw)({id:t.query.id,chapterId:e});d.value.push(a)}finally{u.value=!1}},I=async()=>{v.value=await(0,r.i4)({id:t.query.id})},S=()=>{!u.value&&k.value&&x(k.value)},A=e=>{d.value=[],x(e.id),m.value=!1,g.value=!1};return x(t.query.chapterId),I(),(e,t)=>{const a=l.A,c=n.A;return(0,i.uX)(),(0,i.CE)("div",{class:"book-read",onClick:t[2]||(t[2]=e=>g.value=!(0,s.R1)(g))},[(0,i.bF)(a,{class:"book-read__list",list:(0,s.R1)(d),"min-item-size":200,buffer:500,loading:(0,s.R1)(u),"on-more":(0,s.R1)(p),"key-field":"chapterId",onScrollBottom:S},{default:(0,i.k6)((({item:e,index:t})=>[(0,i.bF)(b,{source:e,index:t},null,8,["source","index"])])),_:1},8,["list","loading","on-more"]),(0,i.bF)(X,{showFlag:(0,s.R1)(g),isNight:(0,s.R1)(h),currentIndex:(0,s.R1)(_),onOpenChapters:f,onChangeMode:C,onChangeColor:y,onMinusFontSize:L,onAddFontSize:F,onBack:R},null,8,["showFlag","isNight","currentIndex"]),(0,s.R1)(m)?((0,i.uX)(),(0,i.CE)("div",{key:0,class:"book-read__catalog",onClick:t[1]||(t[1]=(0,o.D$)((()=>{}),["stop"]))},[(0,i.Lk)("div",w,[(0,i.Lk)("i",{class:"book-read__catalog-header-back icon-back",onClick:t[0]||(t[0]=e=>m.value=!1)}),t[3]||(t[3]=(0,i.Lk)("span",{class:"book-read__catalog-header-label"},"返回",-1))]),(0,i.bF)(c,{class:"book-read__catalog-panel",list:(0,s.R1)(v),onChange:A},null,8,["list"])])):(0,i.Q3)("",!0)])}}});const z=(0,m.A)(E,[["__scopeId","data-v-3a3bb7bd"]]);var K=z},2699:function(e,t,a){a.d(t,{A:function(){return z}});var n=a(4726),l=a(6768),i=a(5828),s=a(6370),o=a(6591);const[c,r]=(0,i.YX)("sidebar"),d=Symbol(c),u={modelValue:(0,s.TU)(0)};var p=(0,l.pM)({name:c,props:u,emits:["change","update:modelValue"],setup(e,{emit:t,slots:a}){const{linkChildren:n}=(0,o.Py)(d),i=()=>+e.modelValue,s=e=>{e!==i()&&(t("update:modelValue",e),t("change",e))};return n({getActive:i,setActive:s}),()=>{var e;return(0,l.bF)("div",{role:"tablist",class:r()},[null==(e=a.default)?void 0:e.call(a)])}}});const v=(0,n.G)(p);a(6647);var k=a(8442),m=a(4548),g=a(3408);const[b,h]=(0,i.YX)("sidebar-item"),_=(0,k.X$)({},m.aI,{dot:Boolean,title:String,badge:s.VQ,disabled:Boolean,badgeProps:Object});var f=(0,l.pM)({name:b,props:_,emits:["click"],setup(e,{emit:t,slots:a}){const n=(0,m.lq)(),{parent:i,index:s}=(0,o.cJ)(d);if(!i)return void 0;const c=()=>{e.disabled||(t("click",s.value),i.setActive(s.value),n())};return()=>{const{dot:t,badge:n,title:o,disabled:r}=e,d=s.value===i.getActive();return(0,l.bF)("div",{role:"tab",class:h({select:d,disabled:r}),tabindex:r?void 0:0,"aria-selected":d,onClick:c},[(0,l.bF)(g.Ex,(0,l.v6)({dot:t,class:h("text"),content:n},e.badgeProps),{default:()=>[a.title?a.title():o]})])}}});const C=(0,n.G)(f);a(7708);var y=a(5632),L=(a(7484),a(4114),a(8111),a(7588),a(144)),F=a(4232);const R={class:"catalog-panel"},x={class:"catalog-panel__header"},I={class:"catalog-panel__content"},S={class:"catalog-panel__list"},A=["onClick"];var X=(0,l.pM)({name:"CatalogPanel",__name:"CatalogPanel",props:{list:{type:Array,required:!0},groupCount:{type:Number,default:50}},emits:["change"],setup(e,{emit:t}){const a=t,n=e,i=(0,L.KR)(!1),s=(0,L.KR)(0),o=(0,l.EW)((()=>{const e=[];let t=-1;return n.list.forEach(((a,l)=>{l%n.groupCount===0&&(t++,e.push({name:`${t*n.groupCount+1}-${t*n.groupCount+n.groupCount}`,chapters:[]})),e[t].chapters.push(a)})),i.value?e.reverse():e})),c=(0,l.EW)((()=>{const e=o.value[s.value]?.chapters||[];return i.value?e.slice().reverse():e})),r=e=>{a("change",e)};return(e,t)=>{const a=y.In,n=C,d=v;return(0,l.uX)(),(0,l.CE)("div",R,[(0,l.Lk)("div",x,[t[2]||(t[2]=(0,l.Lk)("div",{class:"catalog-panel__header-title"},"目录",-1)),(0,l.Lk)("div",{class:"catalog-panel__header-sort",onClick:t[0]||(t[0]=e=>i.value=!(0,L.R1)(i))},[(0,l.bF)(a,{name:"sort"}),(0,l.eW)(" "+(0,F.v_)((0,L.R1)(i)?"正序":"倒序"),1)])]),(0,l.Lk)("div",I,[(0,l.bF)(d,{class:"catalog-panel__sidebar",modelValue:(0,L.R1)(s),"onUpdate:modelValue":t[1]||(t[1]=e=>(0,L.i9)(s)?s.value=e:null)},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)((0,L.R1)(o),((e,t)=>((0,l.uX)(),(0,l.Wv)(n,{key:t,title:e.name},null,8,["title"])))),128))])),_:1},8,["modelValue"]),(0,l.Lk)("div",S,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)((0,L.R1)(c),((e,t)=>((0,l.uX)(),(0,l.CE)("div",{key:t,class:"catalog-panel__list-item",onClick:t=>r(e)},(0,F.v_)(e.title),9,A)))),128))])])])}}}),w=a(1241);const E=(0,w.A)(X,[["__scopeId","data-v-0fe9ac59"]]);var z=E},6431:function(e,t,a){a.d(t,{A:function(){return c}});var n=a(6768),l=a(144),i=(0,n.pM)({name:"VirtualList",__name:"VirtualList",props:{list:{type:Array,required:!0},minItemSize:{type:Number,required:!0},buffer:{type:Number,default:0},loading:{type:Boolean,default:!1},onMore:{type:Boolean,default:!1},keyField:{type:String,default:"id"}},emits:["scroll-bottom","current-item-index"],setup(e,{emit:t}){const a=t,i=e,s=(0,n.EW)((()=>i.list.length)),o=(0,l.KR)(-1),c=(e,t,n,l)=>{cancelAnimationFrame(o.value),o.value=requestAnimationFrame((()=>{t===s.value&&a("scroll-bottom"),a("current-item-index",l)}))};return(t,a)=>{const l=(0,n.g2)("DynamicScrollerItem"),i=(0,n.g2)("DynamicScroller");return(0,n.uX)(),(0,n.Wv)(i,{items:e.list,"min-item-size":e.minItemSize,class:"virtual-list",buffer:e.buffer,emitUpdate:"",keyField:e.keyField,onUpdate:c},(0,n.eX)({default:(0,n.k6)((({item:e,index:a,active:i})=>[(0,n.bF)(l,{item:e,active:i,"data-index":a},{default:(0,n.k6)((()=>[(0,n.RG)(t.$slots,"default",{item:e,active:i,index:a})])),_:2},1032,["item","active","data-index"])])),_:2},[e.loading||0!==e.list.length?void 0:{name:"empty",fn:(0,n.k6)((()=>[a[0]||(a[0]=(0,n.Lk)("div",{class:"virtual-list__empty"},"暂无数据",-1))])),key:"0"},e.loading&&!e.onMore?{name:"after",fn:(0,n.k6)((()=>[a[1]||(a[1]=(0,n.Lk)("div",{class:"virtual-list__loading"},"Loading ...",-1))])),key:"1"}:void 0]),1032,["items","min-item-size","buffer","keyField"])}}}),s=a(1241);const o=(0,s.A)(i,[["__scopeId","data-v-884d42d2"]]);var c=o}}]);
//# sourceMappingURL=890.55bce9be.js.map