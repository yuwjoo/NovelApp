"use strict";(self["webpackChunknovel_web"]=self["webpackChunknovel_web"]||[]).push([[53],{2699:function(e,t,a){a.d(t,{A:function(){return w}});var o=a(4726),n=a(6768),i=a(5828),s=a(6370),l=a(6591);const[c,r]=(0,i.YX)("sidebar"),d=Symbol(c),u={modelValue:(0,s.TU)(0)};var g=(0,n.pM)({name:c,props:u,emits:["change","update:modelValue"],setup(e,{emit:t,slots:a}){const{linkChildren:o}=(0,l.Py)(d),i=()=>+e.modelValue,s=e=>{e!==i()&&(t("update:modelValue",e),t("change",e))};return o({getActive:i,setActive:s}),()=>{var e;return(0,n.bF)("div",{role:"tablist",class:r()},[null==(e=a.default)?void 0:e.call(a)])}}});const k=(0,o.G)(g);a(6647);var v=a(8442),p=a(4548),b=a(3408);const[m,h]=(0,i.YX)("sidebar-item"),f=(0,v.X$)({},p.aI,{dot:Boolean,title:String,badge:s.VQ,disabled:Boolean,badgeProps:Object});var S=(0,n.pM)({name:m,props:f,emits:["click"],setup(e,{emit:t,slots:a}){const o=(0,p.lq)(),{parent:i,index:s}=(0,l.cJ)(d);if(!i)return void 0;const c=()=>{e.disabled||(t("click",s.value),i.setActive(s.value),o())};return()=>{const{dot:t,badge:o,title:l,disabled:r}=e,d=s.value===i.getActive();return(0,n.bF)("div",{role:"tab",class:h({select:d,disabled:r}),tabindex:r?void 0:0,"aria-selected":d,onClick:c},[(0,n.bF)(b.Ex,(0,n.v6)({dot:t,class:h("text"),content:o},e.badgeProps),{default:()=>[a.title?a.title():l]})])}}});const _=(0,o.G)(S);a(7708);var C=a(5632),y=(a(7484),a(4114),a(8111),a(7588),a(144)),R=a(4232);const L={class:"catalog-panel"},F={class:"catalog-panel__header"},z={class:"catalog-panel__content"},x={class:"catalog-panel__list"},I=["onClick"];var A=(0,n.pM)({name:"CatalogPanel",__name:"CatalogPanel",props:{list:{type:Array,required:!0},groupCount:{type:Number,default:50}},emits:["change"],setup(e,{emit:t}){const a=t,o=e,i=(0,y.KR)(!1),s=(0,y.KR)(0),l=(0,n.EW)((()=>{const e=[];let t=-1;return o.list.forEach(((a,n)=>{n%o.groupCount===0&&(t++,e.push({name:`${t*o.groupCount+1}-${t*o.groupCount+o.groupCount}`,chapters:[]})),e[t].chapters.push(a)})),i.value?e.reverse():e})),c=(0,n.EW)((()=>{const e=l.value[s.value]?.chapters||[];return i.value?e.slice().reverse():e})),r=e=>{a("change",e)};return(e,t)=>{const a=C.In,o=_,d=k;return(0,n.uX)(),(0,n.CE)("div",L,[(0,n.Lk)("div",F,[t[2]||(t[2]=(0,n.Lk)("div",{class:"catalog-panel__header-title"},"目录",-1)),(0,n.Lk)("div",{class:"catalog-panel__header-sort",onClick:t[0]||(t[0]=e=>i.value=!(0,y.R1)(i))},[(0,n.bF)(a,{name:"sort"}),(0,n.eW)(" "+(0,R.v_)((0,y.R1)(i)?"正序":"倒序"),1)])]),(0,n.Lk)("div",z,[(0,n.bF)(d,{class:"catalog-panel__sidebar",modelValue:(0,y.R1)(s),"onUpdate:modelValue":t[1]||(t[1]=e=>(0,y.i9)(s)?s.value=e:null)},{default:(0,n.k6)((()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)((0,y.R1)(l),((e,t)=>((0,n.uX)(),(0,n.Wv)(o,{key:t,title:e.name},null,8,["title"])))),128))])),_:1},8,["modelValue"]),(0,n.Lk)("div",x,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)((0,y.R1)(c),((e,t)=>((0,n.uX)(),(0,n.CE)("div",{key:t,class:"catalog-panel__list-item",onClick:t=>r(e)},(0,R.v_)(e.title),9,I)))),128))])])])}}}),E=a(1241);const X=(0,E.A)(A,[["__scopeId","data-v-0fe9ac59"]]);var w=X},6053:function(e,t,a){a.r(t),a.d(t,{default:function(){return N}});var o=a(2699),n=a(6431),i=(a(4114),a(6768)),s=a(144),l=a(5130),c=a(6275),r=a(3625),d=a(4232);const u={class:"book-item"},g={class:"book-item__title"};function k(e,t,a,o,n,s){return(0,i.uX)(),(0,i.CE)("div",u,[(0,i.Lk)("h1",g,(0,d.v_)(a.source.title),1),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(a.source.contents,((e,t)=>((0,i.uX)(),(0,i.CE)("p",{class:"book-item__text",key:t},(0,d.v_)(e),1)))),128))])}var v={name:"bookItem",props:{index:{type:Number},source:{type:Object,default(){return{}}}}},p=a(1241);const b=(0,p.A)(v,[["render",k],["__scopeId","data-v-78ae6bc7"]]);var m=b;const h={class:"back-group"},f={class:"setting-wrapper"},S={class:"setting-color"},_=["onClick"],C={class:"icon-tick"},y={class:"setting-font"},R={class:"setting-btn"},L={class:"setting-item"},F=["textContent"];function z(e,t,a,o,n,s){return(0,i.uX)(),(0,i.Wv)(l.eB,{name:"setting"},{default:(0,i.k6)((()=>[(0,i.bo)((0,i.Lk)("div",null,[(0,i.Lk)("div",h,[(0,i.Lk)("div",{class:"back-content",onClick:t[0]||(t[0]=(0,l.D$)(((...e)=>s.back&&s.back(...e)),["stop"]))},t[6]||(t[6]=[(0,i.Lk)("i",{class:"icon-arrow"},null,-1),(0,i.Lk)("span",null,"返回",-1)]))]),(0,i.bo)((0,i.Lk)("div",f,[(0,i.Lk)("div",S,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(n.color,((e,t)=>((0,i.uX)(),(0,i.CE)("div",{class:"color-item",key:t},[(0,i.Lk)("span",{class:(0,d.C4)(["item",{active:e===n.bookReadSetting.settings.customBg}]),style:(0,d.Tr)({background:e}),onClick:t=>s.changeColor(e)},[(0,i.bo)((0,i.Lk)("i",C,null,512),[[l.aG,e===n.bookReadSetting.settings.customBg]])],14,_)])))),128))]),(0,i.Lk)("div",y,[(0,i.Lk)("div",{class:"font-item",onClick:t[1]||(t[1]=(...e)=>s.minusFontSize&&s.minusFontSize(...e))},t[7]||(t[7]=[(0,i.Lk)("span",{class:"font-btn"},"A-",-1)])),(0,i.Lk)("div",{class:"font-item",onClick:t[2]||(t[2]=(...e)=>s.addFontSize&&s.addFontSize(...e))},t[8]||(t[8]=[(0,i.Lk)("span",{class:"font-btn"},"A+",-1)]))])],512),[[l.aG,a.showFlag&&n.setting]]),(0,i.Lk)("div",R,[(0,i.Lk)("div",L,[(0,i.Lk)("div",{class:"icon-wrapper",onClick:t[3]||(t[3]=(...e)=>s.openChapters&&s.openChapters(...e))},t[9]||(t[9]=[(0,i.Lk)("i",{class:"icon-directory"},null,-1)])),t[10]||(t[10]=(0,i.Lk)("span",{class:"title"},"目录",-1))]),(0,i.Lk)("div",{class:"setting-item",onClick:t[4]||(t[4]=(...e)=>s.changeMode&&s.changeMode(...e))},[(0,i.Lk)("i",{class:(0,d.C4)(s.modeCls)},null,2),(0,i.Lk)("span",{class:"title",textContent:(0,d.v_)(s.modeText)},null,8,F)]),(0,i.Lk)("div",{class:"setting-item",onClick:t[5]||(t[5]=(...e)=>s.openSetting&&s.openSetting(...e))},t[11]||(t[11]=[(0,i.Lk)("i",{class:"icon-setting"},null,-1),(0,i.Lk)("span",{class:"title"},"设置",-1)]))])],512),[[l.aG,a.showFlag]])])),_:1})}var x=a(2261);const I=(0,x.nY)("bookReadSetting",(()=>{const e=(0,s.Kh)(JSON.parse(localStorage.getItem("bookReadSettings"))||{isNight:!1,customBg:"#f6f6f6",fontSizeScale:0}),t=(0,i.EW)((()=>({night:{bg:"#1b1b1b",color:"#6e6e6e",fontSizeScale:e.fontSizeScale},light:{bg:e.customBg,color:"#101010",fontSizeScale:e.fontSizeScale}}))),a=(0,i.EW)((()=>e.isNight?t.value.night:t.value.light)),o=(t,a)=>{e[t]=a,localStorage.setItem("bookReadSettings",JSON.stringify(e))};return{settings:e,mode:t,currentMode:a,setSetting:o}}));var A={props:{showFlag:{type:Boolean,default:!1}},data(){return{setting:!1,color:["#f6f6f6","#e1d4b2","#bed8ab","#efc1c1","#dcc49e","#d9e8ff"],bookReadSetting:I()}},computed:{modeCls(){return this.bookReadSetting.settings.isNight?"icon-brightness":"icon-night"},modeText(){return this.bookReadSetting.settings.isNight?"白天":"夜间"}},methods:{back(){this.$emit("back")},openChapters(){this.$emit("openChapters")},changeMode(){this.bookReadSetting.setSetting("isNight",!this.bookReadSetting.settings.isNight)},openSetting(){this.setting=!this.setting},changeColor(e){e!==this.bookReadSetting.settings.customBg&&this.bookReadSetting.setSetting("customBg",e)},minusFontSize(){this.bookReadSetting.settings.fontSizeScale<=-5||this.bookReadSetting.setSetting("fontSizeScale",this.bookReadSetting.settings.fontSizeScale-1)},addFontSize(){this.bookReadSetting.settings.fontSizeScale>=5||this.bookReadSetting.setSetting("fontSizeScale",this.bookReadSetting.settings.fontSizeScale+1)}},watch:{showFlag(e){!1===e&&(this.setting=!1)}}};const E=(0,p.A)(A,[["render",z],["__scopeId","data-v-67d6d246"]]);var X=E;const w={class:"book-read__catalog-header"};var K=(0,i.pM)({name:"bookRead",__name:"index",setup(e){const t=(0,c.l)(),a=(0,c.r)(),d=I(),u=(0,i.rk)("bookReadRef"),g=(0,s.KR)([]),k=(0,s.KR)(!1),v=(0,s.KR)(!1),p=(0,s.KR)([]),b=(0,i.EW)((()=>g.value[g.value.length-1].nextChapterId)),h=(0,s.KR)(!1),f=(0,s.KR)(!1),S=()=>{f.value=!1,h.value=!0},_=()=>{a.back()},C=async e=>{try{k.value=!0;const a=await(0,r.nw)({id:t.query.id,chapterId:e});g.value.push(a)}finally{k.value=!1}},y=async()=>{p.value=await(0,r.i4)({id:t.query.id})},R=()=>{!k.value&&b.value&&C(b.value)},L=e=>{g.value=[],C(e.id),h.value=!1,f.value=!1};return C(t.query.chapterId),y(),(0,i.sV)((()=>{(0,i.nT)((()=>{if(!u.value)return;const e=d.currentMode;u.value.style.setProperty("--book-read-bg",e.bg),u.value.style.setProperty("--book-read-color",e.color),u.value.style.setProperty("--book-read-title-color",d.settings.isNight?e.color:""),u.value.style.setProperty("--book-read-font-size-scale",e.fontSizeScale+"px")}))})),(e,t)=>{const a=n.A,c=o.A;return(0,i.uX)(),(0,i.CE)(i.FK,null,[(0,i.Lk)("div",{class:"book-read",ref_key:"bookReadRef",ref:u,onClick:t[2]||(t[2]=e=>f.value=!(0,s.R1)(f))},[(0,i.bF)(a,{class:"book-read__list",list:(0,s.R1)(g),"min-item-size":200,buffer:500,loading:(0,s.R1)(k),"on-more":(0,s.R1)(v),"key-field":"chapterId",onScrollBottom:R},{default:(0,i.k6)((({item:e,index:t})=>[(0,i.bF)(m,{source:e,index:t},null,8,["source","index"])])),_:1},8,["list","loading","on-more"]),(0,s.R1)(h)?((0,i.uX)(),(0,i.CE)("div",{key:0,class:"book-read__catalog",onClick:t[1]||(t[1]=(0,l.D$)((()=>{}),["stop"]))},[(0,i.Lk)("div",w,[(0,i.Lk)("i",{class:"book-read__catalog-header-back icon-back",onClick:t[0]||(t[0]=e=>h.value=!1)}),t[3]||(t[3]=(0,i.Lk)("span",{class:"book-read__catalog-header-label"},"返回",-1))]),(0,i.bF)(c,{class:"book-read__catalog-panel",list:(0,s.R1)(p),onChange:L},null,8,["list"])])):(0,i.Q3)("",!0)],512),(0,i.bF)(X,{showFlag:(0,s.R1)(f),onOpenChapters:S,onBack:_},null,8,["showFlag"])],64)}}});const B=(0,p.A)(K,[["__scopeId","data-v-93c80088"]]);var N=B},6431:function(e,t,a){a.d(t,{A:function(){return c}});var o=a(6768),n=a(144),i=(0,o.pM)({name:"VirtualList",__name:"VirtualList",props:{list:{type:Array,required:!0},minItemSize:{type:Number,required:!0},buffer:{type:Number,default:0},loading:{type:Boolean,default:!1},onMore:{type:Boolean,default:!1},keyField:{type:String,default:"id"}},emits:["scroll-bottom","current-item-index"],setup(e,{emit:t}){const a=t,i=e,s=(0,o.EW)((()=>i.list.length)),l=(0,n.KR)(-1),c=(e,t,o,n)=>{cancelAnimationFrame(l.value),l.value=requestAnimationFrame((()=>{t===s.value&&a("scroll-bottom"),a("current-item-index",n)}))};return(t,a)=>{const n=(0,o.g2)("DynamicScrollerItem"),i=(0,o.g2)("DynamicScroller");return(0,o.uX)(),(0,o.Wv)(i,{items:e.list,"min-item-size":e.minItemSize,class:"virtual-list",buffer:e.buffer,emitUpdate:"",keyField:e.keyField,onUpdate:c},(0,o.eX)({default:(0,o.k6)((({item:e,index:a,active:i})=>[(0,o.bF)(n,{item:e,active:i,"data-index":a},{default:(0,o.k6)((()=>[(0,o.RG)(t.$slots,"default",{item:e,active:i,index:a})])),_:2},1032,["item","active","data-index"])])),_:2},[e.loading||0!==e.list.length?void 0:{name:"empty",fn:(0,o.k6)((()=>[a[0]||(a[0]=(0,o.Lk)("div",{class:"virtual-list__empty"},"暂无数据",-1))])),key:"0"},e.loading&&!e.onMore?{name:"after",fn:(0,o.k6)((()=>[a[1]||(a[1]=(0,o.Lk)("div",{class:"virtual-list__loading"},"Loading ...",-1))])),key:"1"}:void 0]),1032,["items","min-item-size","buffer","keyField"])}}}),s=a(1241);const l=(0,s.A)(i,[["__scopeId","data-v-884d42d2"]]);var c=l}}]);
//# sourceMappingURL=53.e1b95ea9.js.map